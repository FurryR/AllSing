function _1029()
{
}
function _2293(_2294)
{
	let _2295;
	_2295=new Array();
	_2295.length=_2294.length;
	let _2296;
	_2296=0;
	for(let _1656=0;_1656<_2294.length;_1656++)
	{
		let _1103;
		_1103 = _2294[_1656];
		let _2297;
		_2297 = _1103._2298();
		let _1102;
		_1102=new Object();
		_2295[_1656]=_1102;
		_1102._2299=_2296;
		_1102._1607=_2297;
		_2296+=_2297;
		_1102._1192=_2296;
	}
	return _2295;
}
function _2300(_2295,_2301)
{
	if(_2295.length<=0)
		return 0;
	let _2302;
	_2302=Math.floor(_2301);
	let _2303;
	_2303=_2301-_2302;
	if(_2302<_2295.length)
	{
		let _333;
		_333=_2295[_2302];
		let _274;
		_274=_333._2299;
		_274+=_333._1607*_2303;
		return _274;
	}
	else
	{
		let _2304;
		_2304=_2295[_2295.length-1];
		let _274;
		_274=_2304._1192;
		_274+=_2304._1607*_2303;
		return _274;
	}
}
function _2305(_2306, _2307)
{
	let _1330;
	_1330 = _2307.constructor;
	var propertyNames = Object.getOwnPropertyNames(_1330.prototype);
	for (let _754 = 0; _754 < propertyNames.length; _754++)
	{
		let _1232 = propertyNames[_754];
		if (_1232 == "constructor" || _1232 == "__defineGetter__" || _1232 == "__defineSetter__" || _1232 == "hasOwnProperty" || _1232 == "__lookupGetter__" || _1232 == "__lookupSetter__" || _1232 == "isPrototypeOf" || _1232 == "propertyIsEnumerable" || _1232 == "toString" || _1232 == "valueOf" || _1232 == "__proto__" || _1232 == "toLocaleString")
			continue;
		let _1331 = _1330.prototype[_1232];
		if (typeof (_1331) == "function")
			_2306[_1232] = _581._1329(_1331,_2306);
		else
			_2306[_1232] = _1331;
	}
	for (let _1232 in _2307)
		_2306[_1232] = _2307[_1232];
}
function _2308(_2306, _2309)
{
	let _1330;
	_1330 = _2309.constructor;
	var propertyNames = Object.getOwnPropertyNames(_1330.prototype);
	for (let _754 = 0; _754 < propertyNames.length; _754++)
	{
		let _1232 = propertyNames[_754];
		if (_1232 == "constructor" || _1232 == "__defineGetter__" || _1232 == "__defineSetter__" || _1232 == "hasOwnProperty" || _1232 == "__lookupGetter__" || _1232 == "__lookupSetter__" || _1232 == "isPrototypeOf" || _1232 == "propertyIsEnumerable" || _1232 == "toString" || _1232 == "valueOf" || _1232 == "__proto__" || _1232 == "toLocaleString")
			continue;
		_2306[_1232] = null;
	}
	for (let _1232 in _2309)
	{
		_2306[_1232] = null;
	}
}
function _270(_2310=-1)
{
	
	var _2311;
	_2311=new _2287();
	let _2312;
	_2312=parent._585;
	for(let _754=0;_754<_2312.length;_754++)
	{
		let _2313;
		_2313 = _2312[_754];
		if (_2313._1147 || _2313._1137 || _2313._1148 || _2313._1164.length==0)
			continue;
		let _2294;
		_2294 = _1141._1654(_2313);
		_2305(_2294, new _2273());
		_2311.push(_2294);
		_2294._1138._2314(_2313._1138);
		let _2053;
		_2053 = _2294.length;
		for (let _1656 = 0; _1656 < _2053; _1656++)
		{
			let _333;
			_333 = _2294[_1656];
			_2305(_333, new _2182());
			_333._2315 = true;
			_333._2316 = true;
			if (_333._2317._2318)
				_333._2317._2319 = true;
			_333._2320 = 0;
			_333._2321.length = 0;
			_333._2269.length = 0;
			_333._2322.length = 0;
			_333._2323.length = 0;
			_333._2324 = 0;
			_333._2325 = 0x3c;
			_333._2326 = 0.5;
			_333._2327 = 0.09375;
			_333._2328 = 0.09375;
		}
		let _2304;
		_2304=_2294[_2294.length-1];
		_2304._2317._2318=true;
		_2304._2317._2319=true;
		_1011._1655(_2294);

		
		
		

	}
	let _2329;
	{
		_2329 = null;
		let _875;
		_875 = parent._584;
		if (_875 == -1)
			_875 = parent._1135;
		if (_875 != -1)
		{
			let _445;
			_445 = _2312[_875];
			_2329 = _445._1153[0];
		}
		if (!_2329)
		{
			for (let _754 = 0; _754 < _2312.length; _754++)
			{
				let _445;
				_2313 = _2312[_754];
				if (_2313._1137 || _2313._1148)
					continue;
				_2329 = _2313._1153[0];
				break;
			}
		}
		if (!_2329)
			_2329 = parent._39.contentWindow._1792()[0]._1891;
	}
	
	let _2330;
	_2330 = _2331._1626(_2311);
	{
		let _824;
		_824 = "";
		if (_2330)
			_824 += "<span style='color: darkgreen; font-size: xx-large;'>" + L("自动谱曲成功！") + "</span><br/><br/>\r\n";
		else
			_824 += "<span style='color:red;'>" + L("自动谱曲失败！") + "</span><br/><br/>\r\n";
		for (let _2332 = 0, _2333 = 0, _2334 = 0; _2332 < _2312.length; _2332++, _2333 = _2334)
		{
			let _2313;
			_2313=_2312[_2332];
			if (_2313._1147 || _2313._1137 || _2313._1148 || _2313._1164.length == 0)
				continue;
			let _2294;
			_2294=_2311[_2333];
			_2334 = _2333 + 1;
			let _2153;
			_2153=_2294._2275;
			let _2281;
			_2281=_2294._2276;
			let _1579;
			_1579 = _1141._1142(_2313);
			_824+=_1579;
			if(_2153=="")
			{
				_2313._1149=null;
			}
			else
			{
				_2313._1149=_2153;
				_824 += "<span title='" + L("点击编辑") + "' style='color:red;cursor:pointer;' onclick='_2389(" + _2333 +");'> &lt;- "+_2153+"</span>\r\n";
			}
			if(_2281=="")
			{
				_2313._1150=null;
			}
			else
			{
				_2313._1150=_2281;
				_824 += "<span title='" + L("点击编辑") + "' style='color:darkgreen;cursor:pointer;' onclick='_2389(" + _2333 +");'> &lt;- "+_2281+"</span>\r\n";
			}
			_824+="<br/>";
		}
		_2335.innerHTML=_824;
	}
	if (!_2330)
	{
		
		let body;
		body = document.body;
		body.scrollTop = body.scrollHeight;
	}
	
	let _2336=new _1633();
	let _2337 = new _658();
	for (let _2332 = 0, _2333 = 0, _2334 = 0; _2332 < _2312.length; _2332++, _2333 = _2334)
	{
		let _2313;
		_2313 = _2312[_2332];
		
		if (_2313._1137)
		{
			
			if (_2310 == -1)
			{
				parent._584 = _581._1337(parent._584, _2332);
				parent._1135 = _581._1337(parent._1135, _2332);
				_2310 = _581._1337(_2310, _2332);
				_2312.splice(_2332, 1);
				_2332--;
			}
			continue;
		}
		if (_2313._1147 || _2313._1148 || _2313._1164.length == 0)
			continue;
		let _2294;
		_2294 = _2311[_2333];
		_2334 = _2333+1;
		if (_2310 != -1)
			if (_2310 != _2332)
				continue;
		if (_2313._1149)
			continue;
		let _2295;
		_2295 = _2293(_2294);
		let _2338, _2339;
		_2338 = _2313._1164;
		_2339 = JSON.stringify(_2338);
		
		for (let _1656 = 0; _1656 < _2294.length; _1656++)
		{
			let _333 = _2294[_1656];
			for (let _1578 = 0; _1578 < _333._2216(); _1578++)
			{
				let _2340;
				_2340 = _333._2251(_1578);
				_2340 = Math.round(_2340);
				_333._2253(_1578, _2340);

				let _1608;
				_1608 = _333._2247(_1578);
				_1608 = Math.round(_1608 * 8) / 8.;
				if (_1608 <= 0)
					_1608 = 1 / 8.;
				_333._2249(_1578,_1608);

				let _2341, _2342;
				_2341 = _333._2229(_1578);
				_2342 = _333._2231(_1578);
				if (_1656 == 0 && _1578 == 0)
					_2341 = 0;
				if (_1656 == _2294.length - 1 && _1578 == _333._2216() - 1)
					_2342 = 0;
				let _2343;
				_2343 = _2341 + _2342;
				if (_2343 > 1)
				{
					_2341 /= _2343;
					_2342 /= _2343;
                }
				_333._2233(_1578, _2341 * _1608);
				_333._2236(_1578, _2342 * _1608);
			}
		}
		
		let _2344, _2345;
		_2344 = _2313._2346;
		_2345 = JSON.stringify(_2344);
		_2344.length = 0;
		function _2347(_2348, _1656)
		{
			let _2349, _2350, _2351;
			_2349 = _2300(_2295, _1656 + _2348.start);
			_2350 = _2300(_2295, _1656 + _2348._2069);
			_2351 = _2300(_2295, _1656 + _2348.stop);
			let _2352;
			_2352 = parent._2353();
			_2344.push(_2352);
			_2352._2354 = "amplitude";
			_2352._2355 = _2349;
			_2352._2356 = _2350;
			_2352._2357 = _2351;
			_2352._2358 = _2348._2070;
			_2352._2359 = _2348._2071;
			_2352._2360 = _2348._2164;
		}
		{
			let _2361;
			_2361 = _2294._2165;
			for (let _2362 = 0; _2362 < _2361.length; _2362++)
			{
				let _2348;
				_2348 = _2361[_2362];
				_2347(_2348, 0);
			}
		}
		for (let _1656 = 0; _1656 < _2294.length; _1656++)
		{
			let _333 = _2294[_1656];
			
			{
				let _2348;
				_2348 = _333._2184;
				if (_2348)
				{
					_2347(_2348, _1656);
					if (_2348._2171)
					{
						let _2363 = new _2163();
						_2363.start = _2348._2172;
						_2363._2069 = _2348._2173;
						_2363.stop = _2348._2174;
						_2363._2070 = _2348._2175;
						_2363._2071 = _2348._2176;
						_2363._2164 = _2348._2177;
						_2347(_2363, _1656);
					}
				}
			}
			
			{
				let _2364;
				_2364 = _333._2185;
				if (_2364)
				{
					let _2349, _2350, _2351;
					_2349 = _2300(_2295, _1656 + _2364.start);
					_2350 = _2300(_2295, _1656 + _2364._2069);
					_2351 = _2300(_2295, _1656 + _2364.stop);
					let _2365;
					_2365 = parent._2353();
					_2344.push(_2365);
					_2365._2354 = "frequency";
					_2365._2355 = _2349;
					_2365._2356 = _2350;
					_2365._2357 = _2351;
					_2365._2358 = _2364._2070;
					_2365._2359 = _2364._2071;
					_2365._2366 = _2364._2164;
				}
			}
			
			{
				let _2367;
				_2367 = _333._2068;
				if (_2367)
				{
					let _2349, _2350, _2351;
					_2349 = _2300(_2295, _1656 + _2367.start);
					_2350 = _2300(_2295, _1656 + _2367._2069);
					_2351 = _2300(_2295, _1656 + _2367.stop);
					let _2368;
					_2368 = parent._2353();
					_2344.push(_2368);
					_2368._2354 = "trill";
					_2368._2355 = _2349;
					_2368._2356 = _2350;
					_2368._2357 = _2351;
					_2368._2358 = _2367._2070;
					_2368._2359 = _2367._2071;
					_2368._2072 = _2367._2072;
					_2368._2073 = _2367._2073;
				}
			}
			
			{
				let _2369;
				_2369 = _333._2186;
				if (_2369)
				{
					let _2349, _2350, _2351;
					_2349 = _2300(_2295, _1656 + _2369.start);
					_2350 = _2300(_2295, _1656 + _2369._2069);
					_2351 = _2300(_2295, _1656 + _2369.stop);
					let _2370;
					_2370 = parent._2353();
					_2344.push(_2370);
					_2370._2354 = "echo";
					_2370._2355 = _2349;
					_2370._2356 = _2350;
					_2370._2357 = _2351;
					_2370._2358 = _2369._2070;
					_2370._2359 = _2369._2071;
					_2370._2180 = _2369._2180;
					let _2371;
					{
						let _1656;
						_1656 = Math.floor(_2369.start);
						if (_1656 < 0 || _1656 >= _2294.length)
						{
							_2371 = 1;
						}
						else
						{
							let _1103;
							_1103 = _2294[_1656];
							_2371 = _1103._2298();
						}
					}
					_2370._2181 = _2371 * _2369._2181;
				}
			}
		}
		_1141._1659(_2313, _2294);
		if (!parent._39.contentWindow._1791(_2313._1153[0]))
			_2313._1153[0] = _2329;
		for (let _657 = 1; _657 < _658._659; _657++)
		{
			if (_2313._1153[_657] != "" || !parent._39.contentWindow._1791(_2313._1153[_657]))
				_2313._1153[_657] = "";
		}
		_2313._1629 = true;
		_2313._1154 = L("丁香");
		
		{
			
			let _2372;
			{
				let _2373 = 0.3;
				_2372 = _2189._2374(_2312, _2332);
				_2372 = _581._761(_2373, 1, 0, 1, _2372);
			}
			_2313._973 = _2337._973 * _2372;
			_2313._974 = 1;
			_2313._993 = _2337._993 * _2372;
			_2313._998 = _2337._998 * _2372;
			_2313._1000 = _2337._1000 * _2372;
		}

		_1011._2375(_2313);

		if (_2339 != JSON.stringify(_2338) || _2345 != JSON.stringify(_2344))
			parent._2376(_2313);
	}
	if(_2310==-1)
		_165();
}
function _1126(_620)
{
	_270(_620);
}
function _165()
{
	let _2312;
	_2312 = parent._585;
	function _2377(_2313)
	{
		
		let _2378;
		_2378 = _2313._1152;
		_2378[0] = F("MidiInstrument✾defalult✾0");
		_2378[1] = F("MidiInstrument✾defalult✾72");
		_2378[2] = F("MidiInstrument✾defalult✾118");
		_2378[3] = F("MidiInstrument✾defalult✾46");
		_2378[4] = F("MidiInstrument✾defalult✾114");

		let _2379;
		_2379 = _2313._2346;
		
		for (let _2380 = 0; _2380 < _2379.length; _2380++)
		{
			let _429;
			_429 = _2379[_2380];
			if (_429._2354 == "frequency" || _429._2354 == "trill" ||_581._1250(_429._2354, "timbre_switch_"))
			{
				_2379.splice(_2380, 1);
				_2380--;
			}
		}

		let _2381;
		{
			_2381 = 0;
			let _1573;
			_1573 = _2313._1164;
			for (let _1578 = 0; _1578 < _1573.length; _1578++)
				_2381 += _1573[_1578]._1635;
		}

		let _2382 = _658._659-1;
		let _2383 = 0;
		let _2384 = 0.5;
		let _2385;
		_2385 = _2381 * (1 - _2383);
		_2385 = _2385 / (_2382 - (_2382 - 1) * _2384);
		let _2386;
		_2386 = _2381 * (1 - _2383);
		_2386 -= _2385;
		_2386 /= (_2382-1);
		for (let _2387 = 0; _2387 < _2382; _2387++)
		{
			let _429 = parent._2353();
			_429._2354 = "timbre_switch_" + (_2387 + 1);
			_429._2355 = _2383 * _2381 + _2386 * _2387;
			_429._2356 = _429._2355 + _2385 * 0.8;
			_429._2357 = _429._2355 + _2385;
			_2379.push(_429);
		}
		_2313._1629 = false;
		_2313._920 = 67;
		_2313._973 *= 0.45;
	}
	for(let _2332=0;_2332<_2312.length;_2332++)
	{
		let _2313;
		_2313=_2312[_2332];
		if(_2313._1137||_2313._1148||_2313._1147)
			continue;
		if(_2332==0)
		{
			parent._2388(0, 0);
			_2377(_2312[0]);
			_2332+=1;
		}
		else if (_2313._1138._1139)
		{
			parent._2388(_2332, _2332);
			_2377(_2312[_2332]);
			_2332 += 1;
		}
		else if(_2332==_2312.length-1)
		{
			parent._2388(_2312.length, _2312.length - 1);
			_2377(_2312[_2332+1]);
			_2332+=1;
		}
	}
}
function _2389(_2390)
{
	if (parent)
	{
		let _2055 = parent._585;
		let _2391;
		_2391 = 0;
		for (let _2392 = 0; _2392 < _2055.length; _2392++)
		{
			let _445;
			_445 = _2055[_2392];
			if (_445._1137 || _445._1147 || _445._1148)
				continue;
			if (_2391 == _2390)
			{
				parent._2393(_2392, true);
				parent._1053();
				return;
			}
			_2391++;
		}
	}
}

