class _1043
{
    
    
    static _1525 =
    [
        
        ["a"  ,"a"],
        ["i"  ,"i"],
        ["M"  ,"u"],
        ["e"  ,"e"],
        ["o"  ,"o"],
        ["k"  ,"k"],
        ["k'" ,"k"],
        ["k'" ,"ky"],
        ["g"  ,"g"],
        ["g'", "g"],
        ["N",  "g"],
        ["N'", "g"],
        ["s",  "s"],
        ["S",  "sh"],
        ["z",  "z"],
        ["Z",  "j"],
        ["dz", "z"],
        ["dZ", "j"],
        ["t",  "t"],
        ["t'", "t"],
        ["ts", "ts"],

        ["tS" ,  "ch"],
        ["d"  ,  "d"],
        ["d'" ,  "d"],
        ["n"  ,  "n"],
        ["J"  ,  "n"],
        ["h"  ,  "h"],
        ["h\\",  "h"],
        ["C"  ,  "h"],
        ["p\\",  "f"],
        ["p\\'", "f"],
        ["b"  ,  "b"],
        ["b'" ,  "b"],
        ["p"  ,  "p"],
        ["p'" ,  "p"],
        ["m"  ,  "m"],
        ["m'" ,  "m"],
        ["j"  ,  "y"],
        ["4"  ,  "r"],
        ["4'",   "ry"], ["4'", "r"],
        ["w"  ,  "w"],
        ["N\\",  "n"],

        ["Sil",  "xtu"],
    ];
    
    
    static _1526 =
    [
        
        ["a", "a"], 
        ["o", "o"], 
        ["7", "e"], 
        ["i", "i"],
            ["i", "yi"],
        ["u", "u"],
            ["u", "wu"],
        ["y", "u"], 
            ["y", "v"], 
            ["y", "yu"], 
        ["@`", "er"],
        ["i\\", "i"],
        ["i`", "i"],
        ["aI", "ai"],
        ["ei", "ei"],
        ["AU", "ao"],
        ["@U", "ou"], 
        ["ia", "ia"],
            ["ia", "ya"],
        ["iE_r","ie"],
            ["iE_r","ye"],
        ["ua", "ua"],
            ["ua", "wa"],
        ["uo", "uo"],
            ["uo", "wo"],
        ["yE_r", "ue"],
            ["yE_r", "ve"],
            ["yE_r", "yue"],
        ["iAU", "iao"],
            ["iAU", "yao"],
        ["i@U", "iu"],
            ["i@U", "you"],
        ["uaI", "uai"],
            ["uaI", "wai"],
        ["uei", "ui"],
            ["uei", "wei"],
        ["a_n", "an"],
        ["@_n", "en"],

        ["i_n", "in"],
            ["i_n", "yin"],
        ["iE_n", "ian"],
            ["iE_n", "yan"],
        ["ua_n","uan"],
            ["ua_n", "wan"],
        ["u@_n","un"],
            ["u@_n", "wen"],
        ["y_n", "un"],
            ["y_n", "yun"],
        ["y{_n", "uan"],
            ["y{_n", "yuan"],
        ["AN", "ang"],
        ["@N", "eng"],
        ["iN", "ing"],
            ["iN", "ying"],
        ["iAN", "iang"],
            ["iAN", "yang"],
        ["uAN", "uang"],
            ["uAN", "wang"],
        ["u@N", "weng"],
        ["UN", "ong"],
        ["iUN", "iong"],
            ["iUN", "yong"],
        ["p", "b"],
        ["p_h", "p"],
        ["m", "m"],
        ["f", "f"],
        ["t", "d"],
        ["t_h", "t"],
        ["n", "n"],
        ["l", "l"],
        ["k", "g"],
        ["k_h", "k"],
        ["x", "h"],
        ["ts\\", "j"],
        ["ts\\_h", "q"],
        ["s\\", "x"],

        ["ts`", "zh"],
        ["ts`_h", "ch"],
        ["s`", "sh"],
        ["z`", "r"],
        ["ts", "z"],
        ["ts_h", "c"],
        ["s", "s"]
    ];

    static _1527 =
    [
            ["あ", "ア", "a"],
            ["い", "イ", "i"],
            ["う", "ウ", "u"],
            ["え", "エ", "e"],
            ["お", "オ", "o"],

            ["ゃ", "ャ", "ja"],
            ["ゅ", "ュ", "jɯ"],
            ["ょ", "ョ", "jo"],


            ["か", "カ", "ka"],
            ["き", "キ", "ki"],
            ["く", "ク", "ku"],
            ["け", "ケ", "ke"],
            ["こ", "コ", "ko"],
            ["きゃ", "キャ", "kya"],
            ["きゅ", "キュ", "kyu"],
            ["きょ", "キョ", "kyo"],

            ["さ", "サ", "sa"],
            ["し", "シ", "shi"],["し", "シ", "si"],
            ["す", "ス", "su"],
            ["せ", "セ", "se"],
            ["そ", "ソ", "so"],
            ["しゃ", "シャ", "sha"],["しゃ", "シャ", "sya"],
            ["しゅ", "シュ", "shu"],["しゅ", "シュ", "syu"],
            ["しょ", "ショ", "sho"],["しょ", "ショ", "syo"],

            ["た", "タ", "ta"],
            ["ち", "チ", "chi"],["ち", "チ", "ti"],
            ["つ", "ツ", "tu"],
            ["て", "テ", "te"],
            ["と", "ト", "to"],
            ["ちゃ", "チャ", "cha"],["ちゃ", "チャ", "tya"], 
            ["ちゅ", "チュ", "chu"],["ちゅ", "チュ", "tyu"], 
            ["ちょ", "チョ", "cho"],["ちょ", "チョ", "tyo"], 


            ["な", "ナ", "na"],
            ["に", "ニ", "ni"],
            ["ぬ", "ヌ", "nu"],
            ["ね", "ネ", "ne"],
            ["の", "ノ", "no"],
            ["にゃ", "ニャ", "nya"],
            ["にゅ", "ニュ", "nyu"],
            ["にょ", "ニョ", "nyo"],


            ["は", "ハ", "ha"],
            ["ひ", "ヒ", "hi"],
            ["ふ", "フ", "fu"],["ふ", "フ", "hu"],
            ["へ", "ヘ", "he"],
            ["ほ", "ホ", "ho"],
            ["ひゃ", "ヒャ", "hya"],
            ["ひゅ", "ヒュ", "hyu"],
            ["ひょ", "ヒョ", "hyo"],

            ["ま", "マ", "ma"],
            ["み", "ミ", "mi"],
            ["む", "ム", "mu"],
            ["め", "メ", "me"],
            ["も", "モ", "mo"],
            ["みゃ", "ミャ", "mya"],
            ["みゅ", "ミュ", "myu"],
            ["みょ", "ミョ", "myo"],

            ["や", "ヤ", "ya"],
            ["ゆ", "ユ", "yu"],
            ["よ", "ヨ", "yo"],

            ["ら", "ラ", "ra"],
            ["り", "リ", "ri"],
            ["る", "ル", "ru"],
            ["れ", "レ", "re"],
            ["ろ", "ロ", "ro"],
            ["りゃ", "リャ", "rya"],
            ["りゅ", "リュ", "ryu"],
            ["りょ", "リョ", "ryo"],

            ["わ", "ワ", "wa"],
            ["_7691", "_7692", "wi"],
            ["_7693", "_7694", "we"],
            ["を", "ヲ", "wo"],

            ["ん", "ン", "n"],

            ["が", "ガ", "ga"],
            ["ぎ", "ギ", "gi"],
            ["ぐ", "グ", "gu"],
            ["げ", "ゲ", "ge"],
            ["ご", "ゴ", "go"],
            ["ぎゃ", "ギャ", "gya"],
            ["ぎゅ", "ギュ", "gyu"],
            ["ぎょ", "ギョ", "gyo"],

            ["ざ", "ザ", "za"],
            ["じ", "ジ", "ji"],["じ", "ジ", "zi"],
            ["ず", "ズ", "zu"],
            ["ぜ", "ゼ", "ze"],
            ["ぞ", "ゾ", "zo"],
            ["じゃ", "ジャ", "ja"],["じゃ", "ジャ", "zya"],
            ["じゅ", "ジュ", "ju"],["じゅ", "ジュ", "zyu"],
            ["じょ", "ジョ", "jo"], ["じょ", "ジョ", "zyo"],


            ["だ", "ダ", "da"],
            ["ぢ", "ヂ", "di"],
            ["づ", "ヅ", "du"],
            ["で", "デ", "de"],
            ["ど", "ド", "do"],
            ["ぢゃ", "ヂャ", "zya"],
            ["ぢゅ", "ヂュ", "zyu"],
            ["ぢょ", "ヂョ", "zyo"],

            ["ば", "バ", "ba"],
            ["び", "ビ", "bi"],
            ["ぶ", "ブ", "bu"],
            ["べ", "ベ", "be"],
            ["ぼ", "ボ", "bo"],
            ["びゃ", "ビャ", "bya"],
            ["びゅ", "ビュ", "byu"],
            ["びょ", "ビョ", "byo"],

            ["ぱ", "パ", "pa"],
            ["ぴ", "ピ", "pi"],
            ["ぷ", "プ", "pu"],
            ["ぺ", "ペ", "pe"],
            ["ぽ", "ポ", "po"],
            ["ぴゃ", "ピャ", "pya"],
            ["ぴゅ", "ピュ", "pyu"],
            ["ぴょ", "ピョ", "pyo"],





            

            ["_7695", "イェ", "ye"],

            ["_7696", "ウィ", "wi"],
            ["_7697", "ウェ", "we"],
            ["_7698", "ウォ", "wo"],

            ["_7699", "_7700", "va"],
            ["_7701", "_7702", "vi"],
            ["_7703", "_7704",   "vu"],
            ["_7705", "_7706", "ve"],
            ["_7707", "_7708", "vo"],

            ["_7709", "スィ", "si"],
            ["_7710", "ズィ", "zi"],

            ["_7711", "シェ", "she"],
            ["_7712", "ジェ", "je"],
            ["_7713", "チェ", "che"],

            ["_7714", "ティ", "ti"],
            ["_7715", "トゥ", "tu"],

            ["_7716", "ツァ", "tsa"],
            ["_7717", "ツィ", "tsi"],
            ["つ", "ツ", "tsu"],
            ["_7718", "ツェ", "tse"],
            ["_7719", "ツォ", "tso"],

            ["_7720", "ファ", "fa"],
            ["_7721", "フィ", "fi"],
            ["_7722", "フェ", "fe"],
            ["_7723", "フォ", "fo"],


            ["_7724","ディ", "di"],
            ["_7725", "ドゥ", "du"],


            ["すゅ","スュ", "syu"],
            ["ずゅ","ズュ", "zyu"],
            ["てゅ","テュ", "tyu"],
            ["でゅ", "デュ", "dyu"],

            ["ふゅ","フュ", "fyu"],
            ["ふょ", "フョ", "fyo"],

            ["_7726", "_7727", "vyu"],

            ["くわ", "_7728", "kwa"],
            ["_7729", "クィ", "kwi"],
            ["_7730", "クェ", "kwe"],
            ["_7731", "クォ", "kwo"],

            ["ぐわ", "_7732", "gwa"],
            ["_7733", "グィ", "gwi"],
            ["_7734", "グェ", "gwe"],
            ["_7735", "グォ", "gwo"],
              

            ["っ", "ッ", "xtu"]
    ];
    static _1029()
    {
        this._1525.sort
            (
                function (_545, _546)
                {
                    return - _545[1].length + _546[1].length;
                }
            );
        this._1526.sort
            (
                function (_545, _546)
                {
                    return - _545[1].length + _546[1].length;
                }
            );
   }
    static _1528(_1529, _1530, _1531)
    {
        
        
        
        {
            let _1532;
            _1532 = _1531.split(" ");
            for (let _754 = 0; _754 < _1532.length; _754++)
            {
                if (_1532[_754].includes("#"))
                {
                    _1532.splice(_754, 1);
                    _754--;
                    continue;
                }
                if (_581._1220(_1532[_754], "_0"))
                    _1532[_754] = _581._1221(_1532[_754], _1532[_754].length - 2);
            }
            if (_1532.length == 2)
                if (_1532[0] == _1532[1])
                    _1532.length = 1;
            _1531 = _1532.join(" ");
        }
        if (!_1531.includes(" "))
        {
            if (_1530 == "-")
                return true;
            for (let _1533 of _1529)
                if (_1533[1] == _1530 && _1533[0] == _1531)
                    return true;
        }
        else
        {
            let _1532;
            _1532 = _1531.split(" ");
            if (_1532.length != 2)
                console.assert(0);
            let _1534, _1535;
            _1534 = _1532[0];
            _1535 = _1532[1];
            for (let _1536 of _1529)
            {
                if (_1536[0] == _1534)
                {
                    let _1537;
                    _1537 = _1536[1];
                    for (let _1538 of _1529)
                    {
                        if (_1538[0] == _1535)
                        {
                            let _1539;
                            _1539 = _1538[1];
                            if (_1537 + _1539 == _1530)
                                return true;
                        }
                    }
                }
            }
        }
        return false;
    }
    static _1540(_1541)
    {
        for (let _1542 of this._1525)
            if (_1542[1] == _1541)
                return _1542[0];
    }
    static _1543(_1541)
    {
        for (let _1544 of this._1527)
            if (_1544[2] == _1541)
                return _1544[1];
        
    }
    static _1545(_1546)
    {
        for (let _1544 of this._1527)
            if (_1544[0] == _1546 || _1544[1] == _1546)
                return _1544[1];
        return _1546;
    }
    static _1547(_1548)
    {
        for (let _1544 of this._1527)
            if (_1544[0] == _1548 || _1544[1] == _1548)
                return _1544[0];
        return _1548;
    }
    static _1549(_1550)
    {
        for (let _1544 of this._1527)
            if (_1544[0] == _1550 || _1544[1] == _1550)
                return _1544[2];
    }
    static _1551(_1541, _1531)
    {
        if (_1541 == "-")
            return true;
        if (_1541 == "っ" || _1541 == "ッ")
            return true;
        if (this._1528(this._1525, _1541, _1531))
            return true;
        
        
        
        return false;
    }
    static _1552(_1553, _1531)
    {
        if (this._1528(this._1526, _1553, _1531))
            return true;
        return false;
    }
    static _1554(_1267)
    {
        if (_1267 == "-" )
            return true;
        if (_1267 == "っ" || _1267 == "ッ")
            return true;
        for (let _308 of this._1527)
            if (_308[2] == _1267)
                return true;
        return false;
    }
    static _1555(_1267)
    {
        if (_1267 == "-")
            return true;
        for (let _308 of this._1527)
            if (_308[0] == _1267 || _308[1] == _1267)
                return true;
        return false;
    }
    static _1556(_1267)
    {
        if (_1267 == "-")
            return true;
        if (_1557._1558.get(_1267))
            return true;
        return false;
    }
    static _1559(_1560, _1561)
    {
        let _1562, _1563;
        for (let _1564 of _1560)
        {
            if (_581._1220(_1561, _1564[1]))
            {
                _1563 = _1564[0];
                if (_1561 != _1564[1])
                {
                    let _1565;
                    _1565 = _581._1221(_1561, _1561.length - _1564[1].length);
                    for (let _1564 of _1560)
                    {
                        if (_581._1220(_1565, _1564[1]))
                        {
                            _1562 = _1564[0];
                            break;
                        }
                    }
                }
                break;
            }
        }
        if (_1562)
            return _1562 + " " + _1563;
        return _1563;
    }
    static _1566(_1541)
    {
        return this._1559(this._1525, _1541);
    }
    static _1567(_1553)
    {
        return this._1559(this._1526, _1553);
    }
    static _1568(_1267)
    {
        if (_1267 == "-")
            return true;
        let _1569;
        _1569 = _576.convertToPinyinStringArray(_1267);
        if (_1569.length <= 0)
            return false;
        if (_1569[0].old_string_index != 0)
            return false;
        return true;
    }
    static _1570(_1267)
    {
        if (_1267 == "-")
            return true;
        return _1571._1558.get(_1267) ? true : false;
    }
    
    
    static _1572(_1573)
    {

    }
    static _1574(_893)
    {
        
        
        
        {
            let _985;
            _985 = JSON.parse(_893);
            if (!_985)
                return "ufData json parses failed";
            let _1575;
            _1575 = _985[F("project")][F("tracks")];
            for (let _1576 = 0; _1576 < _1575.length; _1576++)
            {
                let _1577;
                _1577 = _1575[_1576];
                let _1573;
                _1573 = _1577[F("notes")];
                for (let _1578 = 0; _1578 < _1573.length; _1578++)
                {
                    let _455;
                    _455 = _1573[_1578];
                    let _1579;
                    _1579 = _455[F("lyric")];
                    if (_1579)
                    {
                        if (_1579 != "-")
                            if (_581._1220(_1579, "-"))
                                _455[F("lyric")] = _1579 = _1579.substr(0, _1579.length - 1);
                    }
                    let _303;
                    _303 = _455[F("phoneme")];
                    if (_303)
                    {
                        if (_581._1250(_303, "[") && _581._1220(_303, "]"))
                            _455[F("phoneme")] = _303 = _303.substr(1, _303.length - 2);
                        if (_303 != "-")
                            if (_581._1220(_303, "-"))
                                _455[F("phoneme")] = _303 = _303.substr(0, _303.length - 1);
                    }
                }
            }
            _893 = JSON.stringify(_985);
        }

        
        let _145;
        _145 = 88;
        let _1575 = new Array();
        {
            let _1580 = new _1261();
            if (!_1580._1264(_893))
                return "ufData json parse failed";
            let _623;
            if (!_1580._1252("project"))
                return "ufData no project found";
            if (((_623 = _1580.String("name"))) === undefined)
                return "ufData no name found";

            if (!_1580._1254("tracks"))
                return "ufData no tracks found";
            _584 = -1;
            _614();
            _605(_623);
            _609(_623);
            _585.length = 0;
            let _1581;
            _1581 = _1580._1266();
            _1575.length = _1581;
            for (let _1576 = 0; _1576 < _1581; _1576++)
            {
                if (_1580._1252(_1576))
                {
                    if (((_623 = _1580.Object("notes"))) !== undefined)
                        _1575[_1576] = _623;
                    _1580._1253(_1576)
                }
            }
            _1580._1255("tracks");

            if (_1580._1254("tempos"))
            {
                if (_1580._1252(0))
                {
                    _145 = _1580._1242("bpm");
                    if (!_145)
                        _145 = 88;
                    _1580._1253();
                }
                _1580._1255("tempos");
            }

            _1580._1253();
        }


        
        let _1582;
        {
            let _1583;
            let _1584;
            let _1585;
            let _1586;
            let _1587;
            let _1588;
            let _1589;
            _1583 = _1584 = _1585 = _1586 = _1587 = _1588 = _1589 = 0;
            for (let _1576 = 0; _1576 < _1575.length; _1576++)
            {
                let _1577;
                _1577 = _1575[_1576];
                _1589 += _1577.length;
                for (let _1578 = 0; _1578 < _1577.length; _1578++)
                {
                    let _455;
                    _455 = _1577[_1578];
                    let _1579;
                    _1579 = _455[F("lyric")];
                    if (!_1579)
                        continue;
                    let _303;
                    _303 = _455[F("phoneme")];
                    if (_1043._1554(_1579))
                        _1583++;
                    if (_1043._1555(_1579))
                        _1584++;
                    if (_1043._1556(_1579))
                        _1585++;
                    if (_1043._1568(_1579))
                        _1586++;
                    if (_303)
                        if (_1043._1551(_1579, _303))
                            _1587++;
                    if (_303)
                        if (_1043._1552(_1579, _303))
                            _1588++;
                }
            }
            if (_1589 > 0)
            {
                _1583 /= _1589;
                _1584 /= _1589;
                _1585 /= _1589;
                _1586 /= _1589;
                _1587 /= _1589;
                _1588 /= _1589;
                let _1590;
                {
                    
                    
                    
                    
                    let _1591, _1592;
                    _1591 = _1592 = 0;
                    function _1593(_1594)
                    {
                        _1591++;
                        if (_1043._1570(_1594))
                            _1592++;
                    }
                    for (let _1576 = 0; _1576 < _1575.length; _1576++)
                    {
                        let _1577;
                        _1577 = _1575[_1576];
                        _1589 += _1577.length;
                        let _1594;
                        _1594 = "";
                        for (let _1578 = 0; _1578 < _1577.length; _1578++)
                        {
                            let _455;
                            _455 = _1577[_1578];
                            let _1579;
                            _1579 = _455[F("lyric")];
                            _1594 += _1579;
                            if (_1594 == "-")
                            {
                                _1594 = "";
                                continue;
                            }
                            if (_581._1220(_1594, "-"))
                            {
                                _1594 = _581._1221(_1594, _1594.length - 1);
                                continue;
                            }
                            else
                            {
                                _1593(_1594);
                                _1594 = "";
                            }
                        }
                        if (_1594)
                        {
                            if (_581._1220(_1594, "-"))
                            {
                                _1594 = _581._1221(_1594, _1594.length - 1);
                                if (_1594)
                                {
                                    _1593(_1594);
                                    _1594 = "";
                                }
                            }
                        }
                    }
                    if (_1591)
                        _1590 = _1592 / _1591;
                    else
                        _1590 = 0;

                    if (_1587 > 0.8 && _1587 > _1588)
                        _1582 = '_7736';
                    else if (_1588 > 0.8 && _1588 > _1587)
                        _1582 = '_1553';
                    else if (_1590 >= _1583 && _1590 >= _1584 && _1590 >= _1585 && _1590 >= _1586)
                        _1582 = '_7737';
                    else if (_1583 >= _1584 && _1583 >= _1585 && _1583 >= _1586 && _1583 >= _1590)
                        _1582 = '_7736';
                    else if (_1584 >= _1583 && _1584 >= _1585 && _1584 >= _1586 && _1584 >= _1590)
                        _1582 = '_7738';
                    else if (_1585 >= _1583 && _1585 >= _1584 && _1585 >= _1586 && _1585 >= _1590)
                        _1582 = '_1553';
                    else
                        _1582 = '_1646';
                }
            }
        }

        
        {
            let _1595 = new Array();
            function _1596(_1597)
            {
                if (_1597 < 0)
                    return;
                let _1598;
                _1598 = _1595.slice(0, _1597 + 1);
                _1043._1599(_1598, _1582, _145);
                _1595 = _1595.slice(_1597 + 1);
            }
            function _1600()
            {
                let _1601;
                _1601 = _1595.length;
                let _1602 = 4;
                let _1603 = 16;
                if (_1601 >= _1603)
                {
                    
                    let _1604;
                    let _1605;
                    _1605 = -1;
                    for (let _754 = _1602-1; _754 < _1601-1; _754++)
                    {
                        
                        if (_1043._1606(_1595[_754 + 1]))
                            continue;
                        let _1607;
                        _1607 = _1043._1608(_1595[_754]);
                        if (_1607 >= _1605)
                        {
                            _1605 = _1607;
                            _1604 = _754;
                        }
                    }
                    _1596(_1604);
                }
                else
                {
                    
                    for (let _754 = _1602 - 1; _754 < _1601-1; _754++)
                    {
                        
                        if (_1043._1606(_1595[_754 + 1]))
                            continue;
                        let _1607;
                        _1607 = _1043._1608(_1595[_754]);
                        if (_1607 >= 2)
                        {
                            _1596(_754);
                            break;
                        }
                    }
                }
            }
            for (let _1576 = 0; _1576 < _1575.length; _1576++)
            {
                let _1577;
                _1577 = _1575[_1576];
                _1595.length = 0;
                for (let _1578 = 0; _1578 < _1577.length; _1578++)
                {
                    let _455;
                    _455 = _1577[_1578];
                    let _1609 = new Object();
                    _581._1324(_1609, _455);
                    
                    
                    {
                        let _1531;
                        _1531 = _455[F("phoneme")];
                        if (_1531)
                        {
                            let _1532;
                            _1532 = _1531.split(" ");
                            let _1610;
                            _1610 = _1532[_1532.length - 1];
                            if ((_1610.length == 3 && _581._1221(_1610, 2) == "br") || _1610 == "Asp")
                            {
                                _1532.length--;
                                if (_1532.length)
                                {
                                    _1609[F("phoneme")] = _1532.join(" ");
                                    _1595.push(_1609);
                                }
                                _1043._1599(_1595, _1582, _145);
                                continue;
                            }

                            
                            let _1611;
                            _1611 = this._1608(_455);
                            if (_1610 == "Sil" && _1611>=3)
                            {
                                _1596(_1595.length - 1);
                                continue;
                            }
                        }
                    }

                    
                    if (_1578 - 1 >= 0)
                    {
                        let _1612;
                        _1612 = _1577[_1578 - 1];
                        let _1613;
                        _1613 = this._1614(-_1612[F("tickOff")] + _455[F("tickOn")]);
                        if (_1613 >= 3)
                        {
                            _1596(_1595.length - 1);
                            
                        }
                    }
                    _1595.push(_1609);
                    _1600();
                }
                if (_1595.length)
                    _1043._1599(_1595, _1582, _145);
            }
        }

        
        if (_585.length == 0)
            _614();
        else
            _584 = -1;
        _616();
        _617._618();
        return "";
    }
    static _1606(_455)
    {
        if (_455[F("lyric")] == '-' || _455[F("lyric")] == '⌒')
            return true;
        return false;
    }
    static _1615(_1607)
    {
        return Math.round(_1607 * 480);
    }
    static _1614(_1616,_1617=true)
    {
        let _987;
        _987 = _1616 / 480;
        let _1618 = 1 / 8;
        _987 = Math.round(_987 / _1618) * _1618;
        if (_1617)
            if (_987 == 0)
                _987 = _1618;
        return _987;
    }
    static _1608(_455, _1617=true)
    {
        return this._1614(-_455[F("tickOn")] + _455[F("tickOff")], _1617);
    }
    static _1619(_1573, _1578)
    {
        function _1620()
        {
            if (_1578 - 1 < 0)
                return true;
            return _1573[_1578 - 1]._1621._1622;
        }
        let _455;
        _455 = _1573[_1578];
        let _358;
        _358 = _455._1621;
        let _1548;
        _1548 = _358._1623;
        let _1624;
        _1624 = _1625._1626(_1548)[0];
        _1625._1627(_358, _1624, _1620());
    }
    static _1599(_1628, _1582, _145)
    {
        
        
        
        
        
        for (let _1578 = 0; _1578 < _1628.length; _1578++)
        {
            let _455;
            _455 = _1628[_1578];
            if (_1582 == "_7736")
            {
                if (!this._1551(_455[F("lyric")], _455[F("phoneme")]))
                {
                    if (_1578 - 1 >= 0)
                    {
                        let _1612;
                        _1612 = _1628[_1578 - 1];
                        if (_581._1220(_1612[F("lyric")], _455[F("lyric")]))
                        {
                            if (_1612[F("key")] != _455[F("key")])
                            {
                                _455[F("lyric")] = "⌒";
                                _455[F("phoneme")] = "⌒";
                            }
                            else
                            {
                                _1612[F("tickOff")] = _455[F("tickOff")];
                                _1628.splice(_1578, 1);
                                _1578--;
                            }
                            continue;
                        }
                    }
                    _455[F("phoneme")] = this._1566(_455[F("lyric")]);
                }
            }
        }


        let _445;
        _445 = new _658();
        _585.push(_445);
        _445._1158 = _145;
        _445._1629 = false;
        _445._920 = 0x3c;
        
        
        
        
        
        
        _615(_445);
        if (_1582 == '_7736' || _1582 == '_7738')
            _445._1156 = "japanese";
        else if (_1582 == "_1553" || _1582 == "_1646")
            _445._1156 = "chinese";
        else if (_1582 == "_7737")
            _445._1156 ="english";
        let _1630;
        _1630 = _445._1164;
        _1630.length = 0;
        for (let _1578 = 0; _1578 < _1628.length; _1578++)
        {
            
            
            
            
            
            
            let _1631;
            _1631 = _1628[_1578];

            let _1632;
            _1632 = new _1633();
            _1630.push(_1632);

            _1632._1634 = _1631[F("key")];
            _1632._1635 = this._1608(_1631);
            _1632._1636();

            if (_1043._1606(_1631))
            {
                
                
                
                
                
                
                _1632._1637 = true;
                continue;
            }

            let _1638;
            _1638 = _1632._1621;
            function _1639()
            {
                if (_1578 < _1628.length - 1)
                {
                    switch (_1582)
                    {
                        case "_7736":
                        case "_7738":
                            return F("、");
                        case "_1553":
                        case "_1646":
                            return F("，");
                        case "_7737":
                            return F(",");
                    }
                }
                else
                {
                    switch (_1582)
                    {
                        case "_7736":
                        case "_7738":
                        case "_1553":
                        case "_1646":
                            return F("。");
                        case "_7737":
                            return F(".");
                    }
                }
                return F(".");
            }
            if (_1631[F("lyric")] == "xtu" || _1631[F("phoneme")] == "Sil")
            {
                _1638._1640 = _1639();
                _1638._1622 = true;
                continue;
            }
            if (_1631[F("lyric")] == "br" )
            {
                
                _1638._1640 = _1639();
                _1638._1622 = true;
                continue;
            }

            switch (_1582)
            {
                case "_7736":
                case "_7738":
                    let _1548;
                    if (_1582 == "_7736")
                        _1548 = this._1543(_1631[F("lyric")]);
                    else
                        _1548 = this._1545(_1631[F("lyric")]);
                    if (!_1548)
                    {
                        _1630.pop();
                        break;
                    }
                    _1638._1623 =
                        _1638._1640 =
                        _1638._1641 =
                        _1638._1642 = _1548;
                    _1638._1643 = 0;
                    _1638._1644 = _1578;
                    this._1619(_1630, _1630.length-1);
                    break;
                case "_1553":
                    if (!this._1552(_1631[F("lyric")], _1631[F("phoneme")]))
                        _1630.pop();
                    else
                    {
                        _1638._1623 = _1631[F("lyric")];
                        _1557._1626(_1638, _1631[F("lyric")]);
                        _1638._1640 = _1638._1642 = "";
                        _1638._1641 = "";
                        _1638._1645 = 1;
                        _1638._1643 = 0;
                        _1638._1644 = _1578;
                    }
                    break;
                case "_1646":
                    {
                        let _1646;
                        _1646 = _1631[F("lyric")];
                        if (!this._1568(_1646))
                            _1630.pop();
                        else
                        {
                            _1638._1640 = _1638._1642 = _1646;
                            _1638._1641 = "";
                            _1638._1645 = 1;
                            _1638._1643 = 0;
                            _1638._1644 = _1578;
                        }
                    }
                    break;
                case "_7737":
                    _1638._1640 = _1631[F("lyric")];
                    _1638._1623 = _1638._1641 = _1638._1642 = "";
                    break;
            }
            
            if (_1578 + 1 < _1628.length)
            {
                let _1647;
                _1647 = _1628[_1578 + 1];
                let _1648;
                _1648 = this._1614(_1647[F("tickOn")] - _1631[F("tickOff")],false);
                if (_1648 >= 1 / 8)
                {
                    let _1649
                    _1649 = new _1633();
                    _1630.push(_1649);
                    _1649._1634 = Math.round((_1631[F("key")] + _1647[F("key")])/2);
                    _1649._1635 = _1648;
                    _1649._1636();
                    let _1638;
                    _1638 = _1649._1621;
                    _1638._1640 = _1639();
                    _1638._1622 = true;
                }
            }
            
        }
        if (_1582 == "_1646")
        {
            let _1579;
            _1579 = _1141._1142(_445);
            _445._451(_1579);
            return;
        }
        if (_1582 == "_1553")
        {
            let _1650 = new Array();
            for (let _1578 = 0; _1578 < _1630.length; _1578++)
            {
                let _455;
                _455 = _1630[_1578];
                if (_455._1637)
                    continue;
                let _358 = _455._1621;
                if (_358._1622)
                    continue;
                _1650.push(_358._1623);
            } 
            let _1651;
            _1651 = _1028._1626(_1650);
            for (let _1578 = 0,_1652=0; _1578 < _1630.length; _1578++)
            {
                let _455;
                _455 = _1630[_1578];
                if (_455._1637)
                    continue;
                let _358 = _455._1621;
                if (_358._1622)
                    continue;
                _358._1640 = _358._1642 = _1651[_1652];
                _1652++;
            } 
        }
        {
            let _1653;
            _1653 = _1141._1654(_445);
            _1011._1655(_1653);
            for (let _1656 = 0; _1656 < _1653.length; _1656++)
                _1653[_1656]._1657._1658(_1653, _1656)
            _1141._1659(_445, _1653);
        }
        _1011._1660(_445);
        _1011._1661(_445);
    }
    static _1662(_358)
    {
        let _1663;
        _1663 = "";
        function _1664(_331)
        {
            if (!_331)
                return;
            _331 = _1665._1666(_331);
            if (_1663.length)
                if (!_581._1220(_1663, ' '))
                    _1663 += ' ';
            _1663 += _331;
        }
        function _1667(_1668)
        {
            _1668 = _1668.replaceAll("𓍱", _1665._1669);
            for (let _754 = 0; _754 < _1668.length; _754++)
            {
                if (_754 + 1 < _1668.length)
                {
                    let _1670;
                    _1670 = _1668[_754 + 1];
                    if (_1670 == "ʰ" || _1670 == "ʷ" || _1670 == "ʲ" || _1670 == "ᵝ")
                    {
                        _1664(_1668.substring(_754, _754+2));
                        _754++;
                        continue;
                    }
                }
                if (_1668[_754] == _1665._1669)
                {
                    _1664("ɤʷ̜");
                    continue;
                }
                _1664(_1668[_754]);
            }
        }
        _1664(_358._1671);
        _1664(_358._1672);
        _1667(_358._1673);
        _1664(_358._1674);
        _1667(_358._1675);
        if (_581._1220(_1663, " "))
            _1663 = _581._1221(_1663, _1663.length - 1);
        let _1531;
        _1531 = CXSampaIpa.ipa2xsampa(_1663);
        return _1531;
    }
    static _1676(_358, _1677)
    {
        if (!_1677)
            return false;
        if (_1625._1678(_358._1642))
            return false;
        return true;
    }
    static _421()
    {
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        

        let _1677;
        _1677 = _53.checked;

        let _1679;
        _1679 = "";
        _1679 +=
            '{\r\n' +
            '  "formatVersion": 1,\r\n' +
            '  "project":\r\n' +
            '  {\r\n' +
            '    "name": "' + _607() +'",\r\n' +
            '    "tracks":\r\n' +
            '    [\r\n' +
            '      {\r\n' +
            '        "name": "track 1",\r\n' +
            '        "notes":\r\n' +
            '        [\r\n';
        let _1680;
        _1680 = 0;
        for (let _620 = 0; _620 < _585.length; _620++)
        {
            let _445;
            _445 = _585[_620];
            if (_445._1137)
                continue;
            let _1681;
            _1681 = _445._1164;
            let _1682;
            if (_445._920 == -1)
                _1682 = 0;
            else
                _1682 = _445._920 - 0x3c;
            for (let _1578 = 0; _1578 < _1681.length; _1578++)
            {
                let _1631;
                _1631 = _1681[_1578];
                let _1683;
                _1683 = _1631._1621;
                let key = _1631._1634 + _1682;
                let _1684 = _1680;
                _1680 += _1631._1635;
                let _1685 = _1680;
                if (_1683._1622)
                    continue;
                let _1686;
                let _1687;
                if (_1631._1637)
                {
                    _1686 = '-';
                    _1687 = '-';
                }
                else
                {
                    
                    switch (_445._1156)
                    {
                        case "chinese":
                            
                            _1686 = _1683._1640;
                            _1687 = _1683._1623;
                            _1687 = _1687.replace(/\d/g, '');
                            _1687 = this._1567(_1687);
                            break;
                        case "cantonese":
                            
                            _1686 = _1683._1640;
                            _1687 = this._1662(_1683);
                            break;
                        case "japanese":
                            if (this._1676(_1683, _1677))
                                _1686 = _1683._1642 + "@" + _1683._1643;
                            else
                                _1686 = this._1547(_1683._1623);
                            _1687 = this._1549(_1683._1623);
                            _1687 = this._1566(_1687);
                            break;
                        case "english":
                            _1686 = _1683._1640 + _1683._1688();
                            _1687 = "";
                            break;
                    }
                }
                _1679 +=
                    '          {\r\n' +
                    '            "key": ' + key +',\r\n' +
                    '            "tickOn": ' + this._1615(_1684) +',\r\n' +
                    '            "tickOff": ' + this._1615(_1685) +',\r\n' +
                    '            "lyric": "' + _1686 +'",\r\n' +
                    '            "phoneme": ' + _1209._1229(_1687) +'\r\n' +
                    '          },\r\n';
            }
        }
        if (_581._1220(_1679, ",\r\n"))
        {
            _1679 = _581._1221(_1679, _1679.length - 3);
            _1679 += "\r\n";
        }
        let _145;
        if (_585.length)
            _145 = _585[Math.floor(_585.length / 2)]._1158;
        else
            _145 = 88;
        _1679 +=
            '        ],\r\n' +
            '        "pitch":\r\n' +
            '        {\r\n' +
            '          "ticks": [\r\n' +
            '            1920,\r\n' +
            '            1925,\r\n' +
            '            1930\r\n' +
            '          ],\r\n' +
            '          "values":\r\n' +
            '          [\r\n' +
            '            62.8,\r\n' +
            '            null,\r\n' +
            '            62.90257538448604\r\n' +
            '          ],\r\n' +
            '          "isAbsolute": true\r\n' +
            '        }\r\n' +
            '      }\r\n' +
            '    ],\r\n' +
            '    "timeSignatures": [\r\n' +
            '      {\r\n' +
            '        "measurePosition": 0,\r\n' +
            '        "numerator": 4,\r\n' +
            '        "denominator": 4\r\n' +
            '      }\r\n' +
            '    ],\r\n' +
            '    "tempos": [\r\n' +
            '      {\r\n' +
            '        "tickPosition": 0,\r\n' +
            '        "bpm": ' + _145 +'\r\n' +
            '      }\r\n' +
            '    ],\r\n' +
            '    "measurePrefix": 0\r\n' +
            '  }\r\n' +
            '}\r\n';
        let _610;
        _610 = _608;
        if (!_610)
            _610 = L("未命名");
        _610 += ".ufdata";
        _1689(_610, _1679);
    }
}
_1043._1029();

